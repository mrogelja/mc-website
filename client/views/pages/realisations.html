<template name="realisations">
    <div class="page realisations">
        <ul class="{{#if zoom }}zooming{{/if}}">
            {{#each $mapped realisations }}
            {{> realisation_thumb }}
            {{/each}}
        </ul>
    </div>
</template>


<template name="realisation_thumb">
    <li class="realisation-thumb {{#if selected}}selected{{/if}} {{#if span}}span-{{span}}{{/if}}"
        data-realisation="{{ _id }}">
        <img class="thumb" src="{{ img }}">
    </li>
</template>


<template name="realisation">
    <div class="page realisation {{#if editable}}editing{{/if}}">
        {{#if editable}}
        <h1 class="title" data-is="title" data-type="text" contenteditable="{{#if editable}}true{{else}}false{{/if}}">
            {{ title}}
        </h1>
        {{else}}
        <h1 class="title">{{ title }}</h1>
        {{/if}}

        <div class="tools">
            <a href="{{ pathFor route='realisations' }}">
                <i class="icon reply"></i>
            </a>

            {{#if currentUser}}
                {{#if editable}}
                <i class="icon unlock" data-stopedit=""></i>
                {{else}}
                <i class="icon lock" data-edit=""></i>
                {{/if}}
            {{/if}}
        </div>

        {{#if editable}}
        <div class="settings">
            <div class="inner">
                <label>Publication</label>
                <form class="ui form">
                    <div class="field">
                        <div class="ui toggle checkbox">
                            <input id="published" type="checkbox" data-is="published" checked="{{#if published }}checked{{/if}}">
                            <label for="published">{{#if published }}Publié{{else}}Brouillon{{/if}}</label>
                        </div>
                    </div>
                </form>

                <label>Date de publication</label>
                <form class="ui form">
                    <div class="field">
                        <input type="date" data-is="published_at" value="{{ publishedAt }}">
                    </div>
                </form>
            </div>
        </div>
        {{/if}}

        <div class="thumb">
            <div class="inner">
                {{#if editable}}
                <label>Imagette</label>
                <div class="ui image">
                    <a class="ui corner label left yellow" data-html="<div contenteditable='true'>{{ img_ }}</div>">
                        <i class="save icon"></i>
                    </a>
                    <img src="{{ img }}" data-is="img" data-type="image">
                </div>
                <form class="ui form">
                    <div class="field">
                        <input type="text" data-is="img" value="{{ img }}">
                    </div>
                </form>

                <label>Image</label>
                <div class="ui image">
                    <a class="ui corner label left yellow" data-html="<div contenteditable='true'>{{ img_full }}</div>">
                        <i class="save icon"></i>
                    </a>
                    <img src="{{ img_full }}" data-is="img_full" data-type="image">
                </div>
                <form class="ui form">
                    <div class="field">
                        <input type="text" data-is="img_full" value="{{ img_full }}">
                    </div>
                </form>
                {{else}}
                <img src="{{ img_full }}" alt="{{ title }}"/>
                {{/if }}
            </div>
        </div>

        <div class="wrapper">
            <div class="inner">
                {{#if editable}}
                <label>Résumé</label>
                <div class="resume write icon" data-is="resume" data-type="text" contenteditable="true">
                    {{ resume }}
                </div>
                {{else}}
                <div class="resume">
                    {{ resume }}
                </div>
                {{/if}}

                {{#if editable}}
                <label>Description</label>
                <div class="description" data-is="description" data-type="rte" contenteditable="true">
                    {{> markdown_editor data=description }}
                </div>
                {{else}}
                <div class="description">
                    {{#markdown}}{{ description }}{{/markdown}}
                </div>
                {{/if}}
            </div>
        </div>
    </div>
</template>